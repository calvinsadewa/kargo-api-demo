for pseudocode see pseudocode.ex